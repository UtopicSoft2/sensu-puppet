<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Defined Type: sensu::check
  
    &mdash; Documentation by YARD 0.9.9
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "puppet_defined_types::sensu::check";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../puppet_defined_type_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (s)</a> &raquo;
    <span class='title'><span class='object_link'>Defined Types</span></span>
     &raquo; 
    <span class="title">sensu::check</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="../puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Defined Type: sensu::check</h1>
<div class="box_info">
  <dl>
    <dt>Defined in:</dt>
    <dd>
      manifests/check.pp
    </dd>
  </dl>
</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">
    <p>[<em>contacts</em>]
  Array of Strings.  Contacts to use for the contact-routing
  Sensu Enterprise feature.  This value corresponds with a sensu::contact
  resource having the same name.
  Default: undef</p>

<p>[<em>standalone</em>]
  Boolean.  When true, scheduled by the client.  When false, listen for published check request
  Set this to &#39;absent&#39; to remove it completely.
  Default: true</p>

<p>[<em>cron</em>]
  String.  When the check should be executed, using the <a href="https://en.wikipedia.org/wiki/Cron#CRON_expression">Cron
  syntax</a>.  Supersedes the
  <code>interval</code> parameter.  Example: <code>&quot;0 0 * * *&quot;</code>.
  Default: &#39;absent&#39;</p>

<p>[<em>interval</em>]
  Integer.  How frequently (in seconds) the check will be executed
  Set this to &#39;absent&#39; to remove it completely.
  Default: 60</p>

<p>[<em>occurrences</em>]
  Integer.  The number of event occurrences before the handler should take action.
  Set this to &#39;absent&#39; to remove it completely.
  Default: undef</p>

<p>[<em>refresh</em>]
  Integer.  The number of seconds sensu-plugin-aware handlers should wait before taking second action.
  Set this to &#39;absent&#39; to remove it completely.
  Default: undef</p>

<p>[<em>source</em>]
  String.  The check source, used to create a JIT Sensu client for an external resource (e.g. a network switch).
  Set this to &#39;absent&#39; to remove it completely.
  Default: undef</p>

<p>[<em>subscribers</em>]
  Array of Strings.  Which subscriptions must execute this check
  Set this to &#39;absent&#39; to remove it completely.
  Default: undef</p>

<p>[<em>low_flap_threshold</em>]
  Integer.  Flap detection - see Nagios Flap Detection: <a href="http://nagios.sourceforge.net/docs/3_0/flapping.html">http://nagios.sourceforge.net/docs/3_0/flapping.html</a>
  Set this to &#39;absent&#39; to remove it completely.
  Default: undef</p>

<p>[<em>high_flap_threshold</em>]
  Integer.  Flap detection - see Nagios Flap Detection: <a href="http://nagios.sourceforge.net/docs/3_0/flapping.html">http://nagios.sourceforge.net/docs/3_0/flapping.html</a>
  Set this to &#39;absent&#39; to remove it completely.
  Default: undef</p>

<p>[<em>timeout</em>]
  Numeric.  Check timeout in seconds, after it fails
  Set this to &#39;absent&#39; to remove it completely.
  Default: undef</p>

<p>[<em>aggregate</em>]
  String.  Aggregates, preventing event floods. Set &#39;aggregate:<name> and &#39;handle&#39;:false, this prevents the
  server from sending to a handler, and makes the aggregated results available under /aggregates in the REST API
  Set this to &#39;absent&#39; to remove it completely.
  Default: undef</p>

<p>[<em>aggregates</em>]
  Array of Strings. An array of aggregates to add to the check. This supercedes the above aggregate parameter
  Set this to &#39;absent&#39; to remove it completely.
  Defaults: undef</p>

<p>[<em>handle</em>]
  Boolean.  When false, check will not be sent to handlers
  Set this to &#39;absent&#39; to remove it completely.
  Default: undef</p>

<p>[<em>publish</em>]
  Boolean.  Unpublished checks. Prevents the check from being triggered on clients. This allows for the definition
  of commands that are not actually &#39;checks&#39; per say, but actually arbitrary commands for remediation
  Set this to &#39;absent&#39; to remove it completely.
  Default: undef</p>

<p>[<em>dependencies</em>]
  Array.  List of checks this check depends on.  Note: The validity of the other checks is not enforced by puppet
  Set this to &#39;absent&#39; to remove it completely.
  Default: undef</p>

<p>[<em>custom</em>]
  Hash. List of custom attributes to include in the check. You can use it to pass any attribute that is not listed here explicitly.
  Default: undef
  Example: { &#39;remediation&#39; =&gt; { &#39;low_remediation&#39; =&gt; { &#39;occurrences&#39; =&gt; [1,2], &#39;severities&#39; =&gt; [1], &#39;command&#39; =&gt; &quot;/bin/command&quot;, &#39;publish&#39; =&gt; false, } } }</p>

<p>[<em>ttl</em>]
  Integer. The time to live (TTL) in seconds until check results are considered stale.
  Set this to &#39;absent&#39; to remove it completely.
  Default: undef</p>

<p>[<em>subdue</em>]
  Hash.  Check subdue configuration
  Set this to &#39;absent&#39; to remove it completely.
  Default: undef</p>

<p>[<em>proxy_requests</em>]
  Hash.  <a href="https://sensuapp.org/docs/latest/reference/checks.html#proxy-requests-attributes">Proxy Check
  Requests</a>
  Since Sensu 0.28.0.  Publishes a check request to every Sensu client which
  matches the defined client attributes.  See the documentation for the format
  of the Hash value.
  Default: undef</p>

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>command</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>ensure</span>
      
      
        <span class='type'>(<tt>Enum['present','absent']</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;present&#39;</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>handlers</span>
      
      
        <span class='type'>(<tt>Variant[Undef,String,Array]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>contacts</span>
      
      
        <span class='type'>(<tt>Optional[Array]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>standalone</span>
      
      
        <span class='type'>(<tt>Variant[Boolean,Enum['absent']]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>cron</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;absent&#39;</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>interval</span>
      
      
        <span class='type'>(<tt>Variant[Integer,Enum['absent']]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>60</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>occurrences</span>
      
      
        <span class='type'>(<tt>Variant[Undef,Pattern[/^(\d+)$/],Integer,Enum['absent']]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>refresh</span>
      
      
        <span class='type'>(<tt>Variant[Undef,Enum['absent'],Integer]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>source</span>
      
      
        <span class='type'>(<tt>Variant[Undef,String,Integer]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>subscribers</span>
      
      
        <span class='type'>(<tt>Variant[Undef,String,Array]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>low_flap_threshold</span>
      
      
        <span class='type'>(<tt>Variant[Undef,Enum['absent'],Integer]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>high_flap_threshold</span>
      
      
        <span class='type'>(<tt>Variant[Undef,Enum['absent'],Integer]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>timeout</span>
      
      
        <span class='type'>(<tt>Variant[Undef,Enum['absent'],Numeric]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>aggregate</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>aggregates</span>
      
      
        <span class='type'>(<tt>Variant[Undef,String,Array]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>handle</span>
      
      
        <span class='type'>(<tt>Variant[Undef,Enum['absent'],Boolean]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>publish</span>
      
      
        <span class='type'>(<tt>Variant[Undef,Enum['absent'],Boolean]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>dependencies</span>
      
      
        <span class='type'>(<tt>Variant[Undef,String,Array]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>custom</span>
      
      
        <span class='type'>(<tt>Optional[Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>ttl</span>
      
      
        <span class='type'>(<tt>Variant[Undef,Enum['absent'],Integer]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>subdue</span>
      
      
        <span class='type'>(<tt>Variant[Undef,Enum['absent'],Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>proxy_requests</span>
      
      
        <span class='type'>(<tt>Variant[Undef,Enum['absent'],Hash]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
</ul>


</div><div class="method_details_list">
  <table class="source_code">
    <tr>
      <td>
        <pre class="lines">


132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
      </td>
      <td>
        <pre class="code"><span class="info file"># File 'manifests/check.pp', line 132</span>

define sensu::check (
  Optional[String]                      $command = undef,
  Enum[&#39;present&#39;,&#39;absent&#39;]              $ensure = &#39;present&#39;,
  Optional[String]                      $type = undef,
  Variant[Undef,String,Array]           $handlers = undef,
  Optional[Array]                       $contacts = undef,
  Variant[Boolean,Enum[&#39;absent&#39;]]       $standalone = true,
  String                                $cron = &#39;absent&#39;,
  Variant[Integer,Enum[&#39;absent&#39;]]       $interval = 60,
  Variant[Undef,Pattern[/^(\d+)$/],Integer,Enum[&#39;absent&#39;]] $occurrences = undef,
  Variant[Undef,Enum[&#39;absent&#39;],Integer] $refresh = undef,
  Variant[Undef,String,Integer]         $source = undef,
  Variant[Undef,String,Array]           $subscribers = undef,
  Variant[Undef,Enum[&#39;absent&#39;],Integer] $low_flap_threshold = undef,
  Variant[Undef,Enum[&#39;absent&#39;],Integer] $high_flap_threshold = undef,
  Variant[Undef,Enum[&#39;absent&#39;],Numeric] $timeout = undef,
  Optional[String]                      $aggregate = undef,
  Variant[Undef,String,Array]           $aggregates = undef,
  Variant[Undef,Enum[&#39;absent&#39;],Boolean] $handle = undef,
  Variant[Undef,Enum[&#39;absent&#39;],Boolean] $publish = undef,
  Variant[Undef,String,Array]           $dependencies = undef,
  Optional[Hash]                        $custom = undef,
  Variant[Undef,Enum[&#39;absent&#39;],Integer] $ttl = undef,
  Variant[Undef,Enum[&#39;absent&#39;],Hash]    $subdue = undef,
  Variant[Undef,Enum[&#39;absent&#39;],Hash]    $proxy_requests = undef,
) {
  if $ensure == &#39;present&#39; and !$command {
    fail(&quot;sensu::check{${name}}: a command must be given when ensure is present&quot;)
  }

  if $subdue =~ Hash {
    if !( has_key($subdue, &#39;days&#39;) and $subdue[&#39;days&#39;] =~ Hash ){
      fail(&quot;sensu::check{${name}}: subdue hash should have a proper format. (got: ${subdue}) See https://sensuapp.org/docs/latest/reference/checks.html#subdue-attributes&quot;)
    }
  }
  if $proxy_requests {
    if $proxy_requests =~ Hash {
      if !( has_key($proxy_requests, &#39;client_attributes&#39;) ) {
        fail(&quot;sensu::check{${name}}: proxy_requests hash should have a proper format.  (got: ${proxy_requests})  See https://sensuapp.org/docs/latest/reference/checks.html#proxy-requests-attributes&quot;)
      }
    } elsif !($proxy_requests == &#39;absent&#39;) {
      fail(&quot;sensu::check{${name}}: proxy_requests must be a hash or &#39;absent&#39; (got: ${proxy_requests})&quot;)
    }
  }

  $check_name = regsubst(regsubst($name, &#39; &#39;, &#39;_&#39;, &#39;G&#39;), &#39;[\(\)]&#39;, &#39;&#39;, &#39;G&#39;)

  # If cron is specified, interval should not be written to the configuration
  if $cron and $cron != &#39;absent&#39; {
    $interval_real = &#39;absent&#39;
  } else {
    $interval_real = $interval
  }

  case $::osfamily {
    &#39;windows&#39;: {
      $etc_dir = &#39;C:/opt/sensu&#39;
      $conf_dir = &quot;${etc_dir}/conf.d&quot;
      $user = undef
      $group = undef
      $file_mode = undef
    }
    default: {
      $etc_dir = &#39;/etc/sensu&#39;
      $conf_dir = &quot;${etc_dir}/conf.d&quot;
      $user = &#39;sensu&#39;
      $group = &#39;sensu&#39;
      $file_mode = &#39;0440&#39;
    }
  }

  # (#463) All plugins must come before all checks.  Collections are not used to
  # avoid realizing any resources.
  Anchor[&#39;plugins_before_checks&#39;]
  ~&gt; Sensu::Check[$name]

  file { &quot;${conf_dir}/checks/${check_name}.json&quot;:
    ensure =&gt; $ensure,
    owner  =&gt; $user,
    group  =&gt; $group,
    mode   =&gt; $file_mode,
    before =&gt; Sensu_check[$check_name],
  }

  sensu_check { $check_name:
    ensure              =&gt; $ensure,
    base_path           =&gt; &quot;${conf_dir}/checks&quot;,
    type                =&gt; $type,
    standalone          =&gt; $standalone,
    command             =&gt; $command,
    handlers            =&gt; $handlers,
    contacts            =&gt; $contacts,
    cron                =&gt; $cron,
    interval            =&gt; $interval_real,
    occurrences         =&gt; $occurrences,
    refresh             =&gt; $refresh,
    source              =&gt; $source,
    subscribers         =&gt; $subscribers,
    low_flap_threshold  =&gt; $low_flap_threshold,
    high_flap_threshold =&gt; $high_flap_threshold,
    timeout             =&gt; $timeout,
    aggregate           =&gt; $aggregate,
    aggregates          =&gt; $aggregates,
    handle              =&gt; $handle,
    publish             =&gt; $publish,
    dependencies        =&gt; $dependencies,
    custom              =&gt; $custom,
    subdue              =&gt; $subdue,
    proxy_requests      =&gt; $proxy_requests,
    require             =&gt; File[&quot;${conf_dir}/checks&quot;],
    notify              =&gt; $::sensu::check_notify,
    ttl                 =&gt; $ttl,
  }
}</pre>
      </td>
    </tr>
  </table>
</div>
</div>

      <div id="footer">
  Generated on Wed Jul 26 19:11:19 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.9 (ruby-2.1.9).
</div>

    </div>
  </body>
</html>